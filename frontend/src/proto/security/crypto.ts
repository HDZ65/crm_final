// Code generated by protoc-gen-ts_proto. DO NOT EDIT.
// versions:
//   protoc-gen-ts_proto  v1.181.2
//   protoc               unknown
// source: security/crypto.proto

/* eslint-disable */

/** Key domain for segmentation */
export enum KeyDomain {
  KEY_DOMAIN_UNSPECIFIED = 0,
  /** KEY_DOMAIN_PII - Personal Identifiable Information */
  KEY_DOMAIN_PII = 1,
  /** KEY_DOMAIN_PAYMENT - Payment-related data */
  KEY_DOMAIN_PAYMENT = 2,
  /** KEY_DOMAIN_AUDIT_SIGNING - Audit log signing */
  KEY_DOMAIN_AUDIT_SIGNING = 3,
  /** KEY_DOMAIN_SECRETS - General secrets */
  KEY_DOMAIN_SECRETS = 4,
  UNRECOGNIZED = -1,
}

/** Key status */
export enum KeyStatus {
  KEY_STATUS_UNSPECIFIED = 0,
  /** KEY_STATUS_ACTIVE - Key is active for encryption and decryption */
  KEY_STATUS_ACTIVE = 1,
  /** KEY_STATUS_DECRYPT_ONLY - Key is only valid for decryption (deprecated) */
  KEY_STATUS_DECRYPT_ONLY = 2,
  /** KEY_STATUS_PENDING_DELETION - Key is scheduled for deletion */
  KEY_STATUS_PENDING_DELETION = 3,
  /** KEY_STATUS_DESTROYED - Key has been deleted/destroyed */
  KEY_STATUS_DESTROYED = 4,
  UNRECOGNIZED = -1,
}

export enum BlindIndexType {
  BLIND_INDEX_TYPE_UNSPECIFIED = 0,
  /** BLIND_INDEX_TYPE_EMAIL - Email: lowercase, trim */
  BLIND_INDEX_TYPE_EMAIL = 1,
  /** BLIND_INDEX_TYPE_PHONE - Phone: digits only, normalized */
  BLIND_INDEX_TYPE_PHONE = 2,
  /** BLIND_INDEX_TYPE_IBAN - IBAN: uppercase, no spaces */
  BLIND_INDEX_TYPE_IBAN = 3,
  /** BLIND_INDEX_TYPE_GENERIC - Generic: as-is */
  BLIND_INDEX_TYPE_GENERIC = 4,
  UNRECOGNIZED = -1,
}

/** Data Encryption Key (DEK) metadata */
export interface DataKey {
  id: string;
  /** Which domain this key belongs to */
  domain: KeyDomain;
  /** Key version (incrementing) */
  version: number;
  /** Environment (dev, staging, prod) */
  environment: string;
  /** Status */
  status: KeyStatus;
  /** Algorithm (e.g., AES-256-GCM) */
  algorithm: string;
  /** Timestamps */
  createdAt?: Date | undefined;
  activatedAt?: Date | undefined;
  deprecatedAt?: Date | undefined;
  scheduledDeletionAt?:
    | Date
    | undefined;
  /** Created by */
  createdBy: string;
  /** Is this the current active key for encryption? */
  isCurrent: boolean;
}

/** Encrypted field metadata (stored alongside ciphertext) */
export interface EncryptedFieldMeta {
  /** Key version used for encryption */
  keyVersion: number;
  /** Key domain */
  domain: KeyDomain;
  /** Algorithm (e.g., AES-256-GCM) */
  algorithm: string;
  /** Nonce/IV (base64 encoded) */
  nonce: Uint8Array;
  /** Additional authenticated data (optional) */
  aad: Uint8Array;
  /** Timestamp of encryption */
  encryptedAt?: Date | undefined;
}

/** Encrypt a value */
export interface EncryptRequest {
  /** Plaintext to encrypt (bytes) */
  plaintext: Uint8Array;
  /** Key domain to use */
  domain: KeyDomain;
  /** Optional: additional authenticated data */
  aad: Uint8Array;
  /** Context (for audit/logging) */
  context: string;
}

export interface EncryptResponse {
  /** Ciphertext (bytes) */
  ciphertext: Uint8Array;
  /** Metadata about the encryption */
  meta?: EncryptedFieldMeta | undefined;
}

/** Decrypt a value */
export interface DecryptRequest {
  /** Ciphertext to decrypt */
  ciphertext: Uint8Array;
  /** Encryption metadata */
  meta?:
    | EncryptedFieldMeta
    | undefined;
  /** Context (for audit/logging) */
  context: string;
}

export interface DecryptResponse {
  /** Decrypted plaintext */
  plaintext: Uint8Array;
}

/** Batch encrypt multiple values */
export interface BatchEncryptRequest {
  items: BatchEncryptRequest_Item[];
  domain: KeyDomain;
  context: string;
}

export interface BatchEncryptRequest_Item {
  id: string;
  plaintext: Uint8Array;
  aad: Uint8Array;
}

export interface BatchEncryptResponse {
  items: BatchEncryptResponse_EncryptedItem[];
  successCount: number;
  failureCount: number;
}

export interface BatchEncryptResponse_EncryptedItem {
  id: string;
  ciphertext: Uint8Array;
  meta?: EncryptedFieldMeta | undefined;
  error: string;
}

/** Batch decrypt multiple values */
export interface BatchDecryptRequest {
  items: BatchDecryptRequest_Item[];
  context: string;
}

export interface BatchDecryptRequest_Item {
  id: string;
  ciphertext: Uint8Array;
  meta?: EncryptedFieldMeta | undefined;
}

export interface BatchDecryptResponse {
  items: BatchDecryptResponse_DecryptedItem[];
  successCount: number;
  failureCount: number;
}

export interface BatchDecryptResponse_DecryptedItem {
  id: string;
  plaintext: Uint8Array;
  error: string;
}

/** Re-encrypt with new key version (for key rotation) */
export interface ReencryptRequest {
  ciphertext: Uint8Array;
  currentMeta?: EncryptedFieldMeta | undefined;
  context: string;
}

export interface ReencryptResponse {
  ciphertext: Uint8Array;
  newMeta?: EncryptedFieldMeta | undefined;
  keyVersionChanged: boolean;
}

/** Generate blind index for searchable encryption */
export interface GenerateBlindIndexRequest {
  /** Value to index (will be normalized) */
  value: string;
  /** Index type (affects normalization) */
  indexType: BlindIndexType;
  /** Key domain for HMAC key */
  domain: KeyDomain;
}

export interface GenerateBlindIndexResponse {
  /** Blind index (HMAC-SHA256, hex encoded) */
  blindIndex: Uint8Array;
  /** Key version used */
  keyVersion: number;
}

/** Batch generate blind indexes */
export interface BatchGenerateBlindIndexRequest {
  items: BatchGenerateBlindIndexRequest_Item[];
  indexType: BlindIndexType;
  domain: KeyDomain;
}

export interface BatchGenerateBlindIndexRequest_Item {
  id: string;
  value: string;
}

export interface BatchGenerateBlindIndexResponse {
  items: BatchGenerateBlindIndexResponse_IndexedItem[];
  keyVersion: number;
}

export interface BatchGenerateBlindIndexResponse_IndexedItem {
  id: string;
  blindIndex: Uint8Array;
  error: string;
}

/** List available keys */
export interface ListKeysRequest {
  domain: KeyDomain;
  environment: string;
  includeDeprecated: boolean;
}

export interface ListKeysResponse {
  keys: DataKey[];
}

/** Get current active key for a domain */
export interface GetCurrentKeyRequest {
  domain: KeyDomain;
  environment: string;
}

export interface GetCurrentKeyResponse {
  key?: DataKey | undefined;
}

/** Rotate key (create new version) */
export interface RotateKeyRequest {
  domain: KeyDomain;
  environment: string;
  reason: string;
}

export interface RotateKeyResponse {
  newKey?: DataKey | undefined;
  oldKey?: DataKey | undefined;
}

/** Schedule key deletion */
export interface ScheduleKeyDeletionRequest {
  keyId: string;
  pendingDays: number;
  reason: string;
}

export interface ScheduleKeyDeletionResponse {
  key?: DataKey | undefined;
}

/** Cancel scheduled deletion */
export interface CancelKeyDeletionRequest {
  keyId: string;
  reason: string;
}

export interface CancelKeyDeletionResponse {
  key?: DataKey | undefined;
}

/** Sign data */
export interface SignRequest {
  data: Uint8Array;
  domain: KeyDomain;
  context: string;
}

export interface SignResponse {
  signature: Uint8Array;
  keyVersion: number;
  algorithm: string;
}

/** Verify signature */
export interface VerifyRequest {
  data: Uint8Array;
  signature: Uint8Array;
  keyVersion: number;
  domain: KeyDomain;
}

export interface VerifyResponse {
  valid: boolean;
}
